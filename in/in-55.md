---
doc_revision: 1
reader_reintern: "Reader-only: re-intern if doc_revision changed since you last read this doc."
doc_id: in_55
doc_role: in_step
doc_scope:
  - repo
  - tests
  - tooling
  - analysis
doc_authority: normative
doc_owner: maintainer
doc_requires:
  - POLICY_SEED.md#policy_seed
  - glossary.md#contract
  - CONTRIBUTING.md#contributing_contract
  - README.md#repo_contract
  - AGENTS.md#agent_obligations
  - in/in-28.md#in_in_28
  - in/in-54.md#in_in_54
doc_reviewed_as_of:
  POLICY_SEED.md#policy_seed: 48
  glossary.md#contract: 43
  CONTRIBUTING.md#contributing_contract: 107
  README.md#repo_contract: 76
  AGENTS.md#agent_obligations: 25
  in/in-28.md#in_in_28: 8
  in/in-54.md#in_in_54: 1
doc_review_notes:
  POLICY_SEED.md#policy_seed: "Reviewed rev48; extraction workflow remains deterministic and policy-compatible."
  glossary.md#contract: "Reviewed rev43; corpus projection preserves typed scenario semantics."
  CONTRIBUTING.md#contributing_contract: "Reviewed rev107; migration workflow includes explicit ratchet outputs for review."
  README.md#repo_contract: "Reviewed rev76; extraction remains repo-internal tooling, not product surface."
  AGENTS.md#agent_obligations: "Reviewed rev25; ambiguity is shifted left into explicit unresolved artifacts."
  in/in-28.md#in_in_28: "Template obligations and artifact contracts are reused."
  in/in-54.md#in_in_54: "Consumes axis/profile/class contracts as authoritative inputs."
doc_change_protocol: POLICY_SEED.md#change_protocol
doc_erasure:
  - formatting
  - typos
doc_sections:
  in_in_55: 1
---

<a id="in_in_55"></a>
# in/in-55.md
## Corpus Projection and Quotient Migration Protocol

### Purpose
Project the existing test corpus into quotient classes and produce deterministic migration artifacts.

### Non-goals
- This step does not decide final graded execution budgets.
- This step does not authorize ontology expansion without governance approval.
- This step does not change runtime command semantics.

---

## Status
- **This step installs:** the extraction pipeline from legacy test structures to `Q_g` classes.
- **This step depends on:** canonical axis/profile contracts from `in-54`.
- **This step unblocks:** graded execution routing (`in-56`) and governance ratchets (`in-57`).
- **Failure mode if absent:** no reliable bridge exists between current suite reality and quotient plans.

---

## Definitions
- **Legacy token:** pre-quotient naming/context fragment from current tests.
- **Normalization map:** deterministic mapping from legacy token to axis value.
- **Assignment:** `(test_id, profile_id) -> class_id | unresolved`.
- **Basis representative:** minimal-cover class witness.
- **Diagnostic representative:** high-discrimination witness for fault localization.

---

## Face / Kit / Solver

### Face (Obligations)
- **F55-1:** Every in-scope test shall receive class assignment or explicit unresolved reason.
- **F55-2:** Normalization maps shall be deterministic and revisioned.
- **F55-3:** Basis and diagnostic representative sets shall be emitted separately.
- **F55-4:** Unresolved set deltas shall be tracked for ratchet gating.

### Kit (Existing machinery)
- Quotient schema and profile definitions from `in/in-54.md#in_in_54`.
- Current suite metadata and naming surfaces.
- Existing CI/reporting infrastructure for artifact persistence.

### Solver (Implementation plan)
1. Parse current tests and extract scenario signals.
2. Normalize legacy signals into canonical axis values.
3. Assign tests to classes per profile.
4. Emit basis and diagnostic candidate sets with unresolved ledger.

---

## Artifact Contract

### Required artifacts
#### `out/quotient_assignment.json`
- **Schema:** test_id, profile_id, class_id or unresolved code
- **Determinism:** stable assignment ordering and IDs

#### `out/quotient_unresolved_ambiguities.json`
- **Schema:** unresolved test_id, ambiguity kind, required action
- **Determinism:** reason codes and ordering stable

#### `out/quotient_basis_candidates.json`
- **Schema:** class_id -> representative tests (minimal cover)
- **Determinism:** tie-break strategy explicit

#### `out/quotient_diagnostic_candidates.json`
- **Schema:** class_id -> discriminating tests for localization
- **Determinism:** ranked by information gain heuristic

### Provenance
- Assignment artifacts are profile-indexed and reproducible.
- Unresolved deltas must be reviewable across revisions.

---

## Admissibility
- **Admissible:** unresolved emission with explicit reason codes.
- **Inadmissible:** silent fallback assignment under ambiguity.
- **Ambiguity policy:** unresolved states are first-class outputs, not hidden defaults.
- **Non-explosion policy:** migration must reduce ad hoc suffix dimensions over time.

---

## Checks as Lemmas
- **Lemma L55-1:** all in-scope tests are assigned or unresolved with reason.
- **Lemma L55-2:** normalization map replay yields identical assignments.
- **Lemma L55-3:** basis set covers all required classes.
- **Lemma L55-4:** unresolved delta is non-increasing under ratchet policy (unless approved).

---

## Success Criteria
- [ ] Assignment coverage reaches 100% assign-or-unresolved.
- [ ] Basis and diagnostic sets are both generated and stable.
- [ ] Unresolved ambiguity report is explicit and actionable.
- [ ] Artifacts are ready inputs for graded execution.

---

## Failure Modes and Diagnostics
- **FM55-1:** Parsing blind spot → tests missing from assignment domain.
- **FM55-2:** Non-deterministic normalization → unstable class mapping.
- **FM55-3:** Overfitted basis set → poor fault localization.
- **FM55-4:** Unresolved debt growth → governance ratchets block promotion.
